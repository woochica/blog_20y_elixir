{{ define "main" }}
<main id="main">
  <header>
  <div class="wrapper">
  <h1>{{ .Title }}</h1>
  {{ if site.Params.search }}
  <input
    id="search"
    type="text"
    placeholder="{{ T "search_placeholder" }}"
    aria-label="{{ T "search_aria_label" }}"
  />
  {{ end }}
  {{ if .Content }}
  <div class="post">
    {{ .Content }}
  </div>
  {{ end }}
  </div>
  </header>

  {{ $prevYear := 9999 }}
  {{ $veryOldYear := 2019 }}
  <section class="index">
    {{ range .Pages.ByLastmod.Reverse }}
      {{ if (gt $prevYear (.Lastmod.Format "2006")) }}
        {{ if (ne $prevYear 9999) }}
        {{ if (gt $prevYear $veryOldYear) }}
        </ul>
        {{ end }}
        {{ end }}
      {{ if (gt $prevYear $veryOldYear) }}
      {{ if (le (.Lastmod.Format "2006") $veryOldYear) }}
      <h1>a long time ago</h1>
      {{ else }}
      <h1>{{ .Lastmod.Format "2006" }}</h1>
      {{ end }}
      {{ end }}
      <ul class="patterns-list index-list">
      {{ end }}
    <li>
      <h2>
        <a href="{{ .RelPermalink }}">
          {{ .Title }}
        </a>
      </h2>
      <div class="dots"></div>
      <div class="meta">
        {{ $langName := cond (eq .Params.Lang "en") "in English" (cond (eq .Params.Lang "hu") "magyarul" (cond (eq .Params.Lang "es") "en espa√±ol" "yolo")) }}
        {{ if (and (isset .Params "lang") ((not (eq .Params.Lang "en")))) }}
        <span class="lang chip">{{ $langName }}</span>
        {{ end }}
        {{ range .Params.tags }}
        <span class="category chip">{{ . }}</span>
        {{ end }}
      </div>
    </li>
    {{ if le $veryOldYear (.Lastmod.Format "2006") }}
    {{ $prevYear = .Date.Format "2006"}}
    {{ end }}
    {{ end }}
    </ul>
  </section>

</main>
{{ end }}
